ckpt: /data/outputs/semcity_16_unet_pre/2023-10-20_174320/checkpoints/last.ckpt
seed: 1
datamodule:
  train_tf:
    _target_: dl_toolbox.transforms.NoOp
  test_tf:
    _target_: dl_toolbox.transforms.ImagenetNormalize
  _target_: dl_toolbox.datamodules.Semcity
  data_path: ${paths.data}
  sup: 16
  unsup: -1
  batch_size_s: 32
  batch_size_u: 2
  steps_per_epoch: 250
  bands:
  - 1
  - 2
  - 3
  num_workers: 6
  merge: main5
  pin_memory: true
module:
  _target_: dl_toolbox.modules.Supervised
  optimizer:
    _target_: torch.optim.SGD
    _partial_: true
    lr: 0.01
    momentum: 0.9
    weight_decay: 0.0005
    nesterov: true
  scheduler:
    _target_: torch.optim.lr_scheduler.MultiStepLR
    _partial_: true
    milestones:
    - 50
    gamma: 0.1
  network:
    _target_: dl_toolbox.networks.SmpUnet
    _partial_: true
    encoder_name: efficientnet-b0
    encoder_weights: null
  ce_loss:
    _target_: torch.nn.CrossEntropyLoss
    ignore_index: -1
    reduction: mean
  dice_loss: null
  batch_tf:
    _target_: dl_toolbox.transforms.NoOp
  tta:
    _target_: dl_toolbox.transforms.TTA
    transforms:
    - _target_: dl_toolbox.transforms.Hflip
    - _target_: dl_toolbox.transforms.Vflip
    - _target_: dl_toolbox.transforms.Transpose1
    - _target_: dl_toolbox.transforms.Transpose2
    reverse:
    - _target_: dl_toolbox.transforms.Hflip
    - _target_: dl_toolbox.transforms.Vflip
    - _target_: dl_toolbox.transforms.Transpose1
    - _target_: dl_toolbox.transforms.Transpose2
callbacks:
  model_summary:
    _target_: pytorch_lightning.callbacks.ModelSummary
    max_depth: 4
paths:
  data: /data
  output_dir: /data/outputs
  code: /d/pfournie/dl_toolbox
trainer:
  _target_: pytorch_lightning.Trainer
  _partial_: true
  default_root_dir: ${hydra:run.dir}
  min_epochs: 1
  max_steps: 1000000
  max_epochs: 100
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  num_sanity_val_steps: 0
  accelerator: gpu
  devices: 1
  check_val_every_n_epoch: 1
  log_every_n_steps: ${datamodule.steps_per_epoch}
  deterministic: false
  max_time: 00:11:30:59
name: pred_semcity_${datamodule.sup}
preds_writer:
  _target_: dl_toolbox.callbacks.TiffPredsWriter
  out_path: /data/outputs/semcity_16_unet_pre/2023-10-20_174320/checkpoints/last
  base: ${datamodule.data_path}
